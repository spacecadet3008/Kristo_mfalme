{% extends 'base.html' %}
{% load static %}

{% block content %}
<style>
    /* Flutter Material 3 Design Tokens */
    :root {
        --md-primary: #6750A4;
        --md-on-primary: #ffffff;
        --md-surface: #fef7ff;
        --md-surface-container: #f3edf7;
        --md-secondary-container: #e8def8;
        --md-on-secondary-container: #1d192b;
        --md-outline: #79747e;
        --shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        --radius-lg: 28px;
        --radius-md: 12px;
    }

    .flutter-wrapper {
        background-color: var(--md-surface);
        min-height: 90vh;
        display: flex;
        justify-content: center;
        padding: 2rem 1rem;
        font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    }

    .m3-card {
        background: var(--md-surface-container);
        border-radius: var(--radius-lg);
        width: 100%;
        max-width: 600px;
        padding: 2rem;
        box-shadow: var(--shadow);
    }

    .m3-title {
        font-size: 24px;
        font-weight: 400;
        color: #1c1b1f;
        margin-bottom: 1.5rem;
        text-align: center;
    }

    .form-section {
        margin-bottom: 1.5rem;
    }

    .label-text {
        display: block;
        font-size: 14px;
        color: var(--md-primary);
        margin-bottom: 0.5rem;
        margin-left: 0.5rem;
    }

    .m3-input {
        width: 100%;
        padding: 12px 16px;
        border: 1px solid var(--md-outline);
        border-radius: 8px;
        background: white;
        font-size: 16px;
        box-sizing: border-box;
        transition: border 0.2s;
    }

    .m3-input:focus {
        outline: none;
        border: 2px solid var(--md-primary);
    }

    /* Leaders Container */
    .leaders-list {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .leader-row {
        background: white;
        border-radius: var(--radius-md);
        padding: 1.2rem;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        animation: m3-fade-in 0.3s ease;
    }

    /* Flutter Tonal Button (+ Add Leader) */
    .btn-tonal {
        background-color: var(--md-secondary-container);
        color: var(--md-on-secondary-container);
        border: none;
        padding: 10px 20px;
        border-radius: 20px;
        font-weight: 500;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        margin-top: 1rem;
    }

    /* Flutter Filled Button (Save) */
    .btn-filled {
        background-color: var(--md-primary);
        color: var(--md-on-primary);
        width: 100%;
        padding: 14px;
        border: none;
        border-radius: 100px;
        font-size: 16px;
        font-weight: 600;
        margin-top: 2rem;
        cursor: pointer;
        box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }

    .btn-filled:hover { opacity: 0.9; }

    @keyframes m3-fade-in {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>

<div class="flutter-wrapper">
    <div class="m3-card">
        <h1 class="m3-title">Add Ministry Leaders</h1>

        <form method="POST" action="{% url 'create_ministry' %}">
            {% csrf_token %}

            <!-- Ministry/Community Selection -->
            <div class="form-section">
                <span class="label-text">Ministry Name</span>
                <input type="text" name="ministry_name" class="m3-input" placeholder="e.g. St. Peters Community" required>
            </div>

            <hr style="border: 0; border-top: 1px solid #ddd; margin: 1.5rem 0;">

            <!-- Dynamic Leaders Section -->
            <div id="leader-container" class="leaders-list">
                <div class="leader-row">
                    <div style="grid-column: span 1;">
                        <span class="label-text">Full Name</span>
                        <input type="text" name="leaders_name[]" class="m3-input" placeholder="John Doe" required>
                    </div>
                    <div style="grid-column: span 1;">
                        <span class="label-text">Position</span>
                        <select name="leaders_position[]" class="m3-input" required>
                            <option value="">Select Rank</option>
                            <option value="CHAIR PERSON">Chairperson</option>
                            <option value="VICE CHAIR">Vice Chair</option>
                            <option value="SECRETARY">Secretary</option>
                            <option value="VICE SECRETARY">Vice Secretary</option>
                            <option value="ACCOUNTANT">Accountant</option>
                            <option value="COORDINATOR">Coordinator</option>
                        </select>
                    </div>
                    <div style="grid-column: span 2;">
                        <span class="label-text">Phone Number</span>
                        <input type="tel" name="leaders_phone[]" class="m3-input" placeholder="+255...">
                    </div>
                </div>
            </div>

            <button type="button" id="add-leader-row" class="btn-tonal">
                <span>+</span> Add Another Leader
            </button>

            <button type="submit" class="btn-filled">SAVE ALL LEADERS</button>
        </form>
    </div>
</div>

<script>
    document.getElementById('add-leader-row').addEventListener('click', function() {
        const container = document.getElementById('leader-container');
        const rows = container.getElementsByClassName('leader-row');
        const newRow = rows[0].cloneNode(true);

        // Clear values in the cloned row
        const inputs = newRow.querySelectorAll('input');
        const selects = newRow.querySelectorAll('select');
        
        inputs.forEach(input => input.value = '');
        selects.forEach(select => select.value = '');

        container.appendChild(newRow);
    });
</script>

{% endblock %}
